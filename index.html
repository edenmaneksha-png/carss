<!DOCTYPE html>
<html>
<head>
<title>Ultimate Train Runner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial;
  text-align:center;
  background:linear-gradient(#87CEEB,#4fa3f7);
  transition:0.5s;
}

#game{
  width:360px;
  height:600px;
  margin:auto;
  background:#222;
  position:relative;
  overflow:hidden;
  border:5px solid black;
}

.track{
  position:absolute;
  width:4px;
  height:100%;
  background:white;
}

.track:nth-child(1){left:120px;}
.track:nth-child(2){left:240px;}

.train{
  width:70px;
  height:110px;
  position:absolute;
  bottom:20px;
  left:145px;
  background:linear-gradient(red,darkred);
  border-radius:15px;
  box-shadow:0 0 20px red;
}

#controls{
  position:absolute;
  bottom:10px;
  width:100%;
  display:none; /* hidden by default */
  justify-content:space-between;
}

#controls button{
  font-size:25px;
  padding:10px 20px;
}

.obstacle{
  width:70px;
  height:110px;
  background:linear-gradient(yellow,orange);
  position:absolute;
  top:-120px;
  border-radius:10px;
}

.coin{
  width:30px;
  height:30px;
  background:gold;
  border-radius:50%;
  position:absolute;
  top:-50px;
  box-shadow:0 0 10px yellow;
}

.rain{
  position:absolute;
  width:2px;
  height:15px;
  background:lightblue;
  animation:rainFall 0.5s linear infinite;
}

@keyframes rainFall{
  from{transform:translateY(-20px);}
  to{transform:translateY(600px);}
}

#gameOver{
  position:absolute;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  color:white;
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

button{
  padding:8px 15px;
  margin-top:10px;
  font-size:18px;
  cursor:pointer;
}
</style>
</head>
<body>

<h2>ðŸš† Ultimate Train Runner</h2>
<h3>Score: <span id="score">0</span> | Coins: <span id="coins">0</span> | High Score: <span id="highScore">0</span></h3>

<div id="game">
  <div class="track"></div>
  <div class="track"></div>
  <div class="train" id="train"></div>

  <div id="gameOver">
    <h1>Game Over</h1>
    <button onclick="restart()">Restart</button>
  </div>

  <div id="controls">
  <button id="leftBtn">â¬…</button>
  <button id="rightBtn">âž¡</button>
</div>
</div>

<script>
let train = document.getElementById("train");
let game = document.getElementById("game");
let score = 0;
let coins = 0;
let speed = 4;
let playing = true;

let lanes = [25,145,265];
let currentLane = 1;

let highScore = localStorage.getItem("trainHighScore") || 0;
document.getElementById("highScore").innerText = highScore;

document.addEventListener("keydown", function(e){
  if(e.key === "ArrowLeft" && currentLane>0){
    currentLane--;
    train.style.left = lanes[currentLane]+"px";
  }
  if(e.key === "ArrowRight" && currentLane<2){
    currentLane++;
    train.style.left = lanes[currentLane]+"px";
  }
});

function createObstacle(){
  if(!playing) return;

  let obs = document.createElement("div");
  obs.classList.add("obstacle");

  let lane = Math.floor(Math.random()*3);
  obs.style.left = lanes[lane]+"px";
  game.appendChild(obs);

  let move = setInterval(()=>{
    if(!playing){clearInterval(move);return;}

    obs.style.top = obs.offsetTop + speed +"px";

    if(obs.offsetTop>460 && lane===currentLane){
      gameOver();
    }

    if(obs.offsetTop>600){
      obs.remove();
      score++;
      document.getElementById("score").innerText=score;

      if(score%5===0){
        speed++;
        toggleDayNight();
      }

      clearInterval(move);
    }
  },20);
}

if(/Mobi|Android/i.test(navigator.userAgent)){
  document.getElementById("controls").style.display = "flex";
}

let startX = 0;

game.addEventListener("touchstart", function(e){
  startX = e.touches[0].clientX;
});

game.addEventListener("touchend", function(e){
  let endX = e.changedTouches[0].clientX;
  let diff = endX - startX;

  if(diff > 50 && currentLane < 2){
    currentLane++;
    train.style.left = lanes[currentLane] + "px";
  }

  if(diff < -50 && currentLane > 0){
    currentLane--;
    train.style.left = lanes[currentLane] + "px";
  }
});

function createCoin(){
  if(!playing) return;

  let coin = document.createElement("div");
  coin.classList.add("coin");

  let lane = Math.floor(Math.random()*3);
  coin.style.left = lanes[lane]+20+"px";
  game.appendChild(coin);

  let move = setInterval(()=>{
    coin.style.top = coin.offsetTop + speed +"px";

    if(coin.offsetTop>470 && lane===currentLane){
      coins++;
      document.getElementById("coins").innerText=coins;
      coin.remove();
      clearInterval(move);
      playSound();
    }

    if(coin.offsetTop>600){
      coin.remove();
      clearInterval(move);
    }
  },20);
}

function createRain(){
  let drop = document.createElement("div");
  drop.classList.add("rain");
  drop.style.left = Math.random()*360+"px";
  game.appendChild(drop);
  setTimeout(()=>drop.remove(),500);
}

function toggleDayNight(){
  if(document.body.style.background.includes("87CEEB")){
    document.body.style.background="linear-gradient(#000022,#000)";
  }else{
    document.body.style.background="linear-gradient(#87CEEB,#4fa3f7)";
  }
}

function playSound(){
  let audio = new Audio("https://www.soundjay.com/buttons/sounds/button-3.mp3");
  audio.play();
}

function gameOver(){
  playing = false;

  // Stop new objects
  clearInterval(obstacleInterval);
  clearInterval(coinInterval);
  clearInterval(rainInterval);

  // Show Game Over screen
  document.getElementById("gameOver").style.display = "flex";

  // Save high score
  if(score > highScore){
    localStorage.setItem("trainHighScore", score);
    document.querySelectorAll(".obstacle, .coin, .rain").forEach(el=>{
  el.style.animation = "none";
});
  }
}

function restart(){
  location.reload();
}

let obstacleInterval = setInterval(createObstacle,1500);
let coinInterval = setInterval(createCoin,2000);
let rainInterval = setInterval(createRain,100);
</script>

</body>
</html>



